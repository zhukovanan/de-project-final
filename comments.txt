Добрый день!

Ты указываешь в комментарии, что небходимо закрыть файл после прочтения в run_sql_command_vertica и load_file:
- в run_sql_command_vertica я использую менеджер создания контекста - зачем тут закрывать файл, если он автоматически закрывается?
- в load_file читаю через read_csv - он разве аналогично автоматом не закрывает файл после прочтения?